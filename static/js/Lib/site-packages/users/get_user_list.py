import jquery
from browser import window,alert
import json
jq=window.jQuery

class GetUserList:
    def __init__(self,user_type):
        self.__cable='/modules/api_cable/get_user_cable.php'
        self.__user_type=user_type
        self.__cb=None
    
    def get_result(self,res,status,xhr):
        if status=='success':
            if self.__cb is not None:
               
                self.__cb(True,json.loads(res))
        else:
            if self.__cb is not None:
                self.__cb(False,None)
    def result_failed(self,res):
        self.__cb(False,None)
    def get_list(
        self,
        cb
    ):
        self.__cb=cb
        full_url=self.__cable+"?user_type="+str(self.__user_type)    
        jq.post(full_url,{
            'get_user_list':'ok'
        },self.get_result).fail(self.result_failed)