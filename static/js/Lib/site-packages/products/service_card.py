import jquery
from browser import window
jq=window.jQuery
class ServiceCard:
    def __init__(self) -> None:
        self.card_lookup='/service/card'
        self.__onload=None
        self.__card_data=None
    
    def load_card_complete(self,res,status,xhr):
        if status=='success':
            if self.__onload is not None:
                
                self.__card_data=res
                self.__onload(self)

    def create_card(self,product_name,product_code,image_content_type, image_data):
        self.copy=self.__card_data.strip()
        image_b64="data:{image_content_type};base64, {image_data}".format(image_content_type = image_content_type, image_data= image_data)
        #self.copy=self.copy.format(product_name= product_name, product_code=product_code , image_b64= image_b64)
        self.copy = self.copy.replace('{product_code}',product_code)
        self.copy = self.copy.replace('{product_name}',product_name)
        self.copy= self.copy.replace('{image_base64}',image_b64)
        print(self.copy)
        return self.copy
    
    def get_service_card(self,cb):
        self.__onload=cb
        jq.get(self.card_lookup, self.load_card_complete)